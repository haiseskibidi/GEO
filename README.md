# Геопортал мониторинга на основе данных дистанционного зондирования

## Обзор проекта

Геопортал представляет собой веб-приложение для визуализации и анализа данных дистанционного зондирования Земли. Система позволяет загружать, просматривать и сравнивать спутниковые снимки, выполнять их поиск по дате и местоположению, а также проводить базовый анализ изменений на земной поверхности.

## Особенности

- Интерактивная карта с поддержкой различных базовых слоев (OpenStreetMap, спутниковые снимки)
- Поиск и фильтрация изображений по дате съемки и облачности
- Просмотр и сравнение разновременных снимков с помощью инструментов "шторка" и "прозрачность"
- Возможность визуального анализа изменений
- Различные режимы рендеринга спутниковых снимков (естественный цвет, цветной инфракрасный, NDVI и др.)
- Настройка параметров отображения изображений (яркость, контраст, насыщенность)
- Поддержка реальных снимков Sentinel-2 и Канопус-В в формате Cloud Optimized GeoTIFF (COG)

## Технологии

- **Frontend**: HTML5, CSS3, JavaScript (ES6+)
- **Картография**: OpenLayers 7
- **Данные**: Реальные спутниковые снимки в формате COG (Cloud Optimized GeoTIFF)
- **Дополнительно**: Python для обработки геоданных и конвертации в COG

## Спутниковые снимки

Большие файлы спутниковых снимков не хранятся в репозитории из-за ограничений размера GitHub. Вы можете скачать их по ссылке:

**[Скачать спутниковые снимки (Яндекс.Диск)](https://disk.yandex.ru/d/1yIhDALG9Jb4kQ)**

После скачивания архива распакуйте его содержимое в директорию `sputniki/` проекта. Структура директорий должна соответствовать той, что описана в следующем разделе.

## Структура проекта

```
geoportal-monitoring/
├── index.html              # Главная HTML страница
├── css/                    # Стили
│   └── main.css            # Основные стили
├── js/                     # JavaScript файлы
│   ├── app.js              # Главный модуль приложения
│   ├── map.js              # Логика работы с картой
│   ├── images.js           # Модуль работы с изображениями
│   ├── controls.js         # Элементы управления
│   └── config.js           # Настройки приложения
├── data/                   # Каталог с данными
│   └── img/                # Каталог с метаданными изображений  
│       └── images.json     # JSON файл с описанием спутниковых снимков
├── sputniki/               # Каталог с спутниковыми снимками (не хранится в репозитории)
│   ├── Sentinel_20200105_COG/ # Снимки Sentinel от 05.01.2020
│   ├── Sentinel_20200414_COG/ # Снимки Sentinel от 14.04.2020
│   └── Canopus_COG/        # Снимки Канопус-В
├── python_scripts/         # Python скрипты для обработки геоданных
│   ├── convert_to_cog.py   # Скрипт для конвертации в Cloud Optimized GeoTIFF (COG)
│   ├── get_geotiff_info.py # Скрипт для получения информации о GeoTIFF файлах
│   └── utm_to_wgs84.py     # Скрипт для конвертации координат из UTM в WGS84
├── start_server.bat        # Скрипт для запуска локального веб-сервера
└── README.md               # Документация
```

## Описание JavaScript файлов

### app.js
Отвечает за инициализацию приложения, связывание модулей и настройку основных компонентов. Это точка входа в приложение, которая запускается после загрузки всех зависимостей.

### map.js
Содержит всю логику работы с картой OpenLayers:
- Инициализация и настройка карты
- Добавление и управление слоями (базовые карты, спутниковые снимки)
- Обработка геопространственных данных
- Реализация инструментов сравнения изображений (шторка, прозрачность)
- Настройка рендеринга и визуализации изображений
- Управление экстентом и навигацией

### images.js
Модуль для работы с каталогом спутниковых снимков:
- Загрузка данных о снимках из JSON-файла
- Поиск и фильтрация изображений по дате и облачности
- Рендеринг списка доступных изображений
- Выбор основного и вторичного изображения для сравнения
- Обновление UI при выборе изображений

### controls.js
Управляет элементами пользовательского интерфейса:
- Обработка пользовательского ввода (кнопки, слайдеры, поля ввода)
- Связывание элементов управления с функциями карты и изображений
- Управление режимами отображения и рендеринга
- Обработка событий UI (клики, изменение значений и т.д.)
- Анимация и визуальные эффекты интерфейса

### config.js
Содержит настройки и константы приложения:
- Параметры по умолчанию для карты и элементов управления
- Конфигурация режимов рендеринга
- Настройки отображения и слоев
- Параметры запросов и обработки данных
- Глобальные константы для использования во всех модулях

## Работа с данными

Геопортал использует данные о спутниковых снимках, хранящиеся в формате JSON (`data/img/images.json`). Каждое изображение описывается следующими параметрами:

```json
{
  "id": "уникальный_идентификатор",
  "name": "Название снимка",
  "date": "YYYY-MM-DD",
  "url": "путь/к/файлу.tif",
  "cloudCoverage": 0-100,
  "extent": [minLon, minLat, maxLon, maxLat],
  "sensor": "Название сенсора"
}
```

Координаты `extent` представлены в градусах (WGS84) в формате [долгота_мин, широта_мин, долгота_макс, широта_макс].

### Запуск геопортала

1. **Способ 1**: Откройте файл `index.html` в браузере для запуска приложения (возможны ограничения CORS при загрузке локальных файлов).
2. **Способ 2**: Для полноценной работы с геопорталом запустите локальный веб-сервер:
   - Запустите файл `start_server.bat`
   - Откройте в браузере:
   ```
   http://localhost:8000/
   ```

## Использование

1. **Поиск изображений**:
   - Используйте фильтры по дате для поиска нужных снимков
   - Результаты отображаются в боковой панели с информацией о снимках

2. **Выбор изображений**:
   - Нажмите кнопку "Основное" для выбора основного изображения
   - Нажмите кнопку "Сравнение" для выбора второго изображения (для режимов сравнения)

3. **Режимы отображения**:
   - "Одиночное изображение" - просмотр одного выбранного снимка
   - "Сравнение (шторка)" - сравнение двух изображений с помощью вертикального разделителя
   - "Сравнение (прозрачность)" - наложение одного изображения на другое с настройкой прозрачности

4. **Режимы рендеринга**:
   - "Естественный цвет" - отображение в естественных цветах (RGB)
   - "Цветной ИК" - подчеркивает растительность
   - "Коротковолновый ИК" - полезен для геологического анализа
   - "Сельское хозяйство" - выделяет различия в сельскохозяйственных культурах
   - "Городская среда" - подчеркивает городскую застройку
   - "Индекс вегетации (NDVI)" - отображает интенсивность растительности
   - "Температура поверхности" - визуализация температурных различий

5. **Настройка изображений**:
   - Используйте слайдеры яркости, контраста и насыщенности для точной настройки
   - Кнопка "Сбросить настройки" возвращает параметры к исходным значениям

6. **Управление картой**:
   - Используйте колесо мыши для масштабирования
   - Перетаскивайте карту для навигации
   - Кнопки "+", "-" и "⟲" для управления масштабом и возврата к исходному виду

## Добавление новых снимков

Для добавления новых спутниковых снимков в геопортал:

1. Поместите GeoTIFF файлы в соответствующие директории в `sputniki/`
2. Используйте скрипт `get_geotiff_info.py` для получения информации о снимке:
   ```
   python python_scripts/get_geotiff_info.py путь/к/файлу.tif
   ```
3. Используйте скрипт `utm_to_wgs84.py` для конвертации UTM координат в WGS84:
   ```
   python python_scripts/utm_to_wgs84.py
   ```
4. Добавьте информацию о снимке в файл `data/img/images.json`

## Планы развития

- Добавление продвинутых инструментов анализа изображений (классификация, изменения)
- Поддержка временных рядов и анимации изменений
- Улучшение интерфейса и производительности
- Добавление инструментов для нанесения аннотаций и измерений

## Авторы

- Проект разработан в рамках учебного задания по геоинформационным системам
 